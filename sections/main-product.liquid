<section class="product-page">
  <div class="container">
    <div class="product-grid">
      <!-- Product Images -->
      <div class="product-media">
        {% if product.images.size > 0 %}
          <div class="product-images">
            <div class="main-image">
              <img
                src="{{ product.featured_image | img_url: '1000x' }}"
                alt="{{ product.title }}"
                id="main-product-image"
                loading="eager"
              >
            </div>

            {% if product.images.size > 1 %}
              <div class="thumbnail-gallery">
                {% for image in product.images limit: 4 %}
                  <button
                    class="thumbnail {% if forloop.first %}active{% endif %}"
                    onclick="changeImage('{{ image | img_url: '1000x' }}', this)"
                  >
                    <img src="{{ image | img_url: '200x' }}" alt="{{ product.title }}">
                  </button>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        {% else %}
          <div class="product-placeholder">
            {{ 'product-1' | placeholder_svg_tag }}
          </div>
        {% endif %}
      </div>

      <!-- Product Info -->
      <div class="product-info">
        {% if product.metafields.custom.scent %}
          <span class="product-scent">{{ product.metafields.custom.scent }}</span>
        {% endif %}

        <h1 class="product-title serif">{{ product.title }}</h1>

        {% if product.metafields.custom.short_description %}
          <p class="product-short-desc">{{ product.metafields.custom.short_description }}</p>
        {% endif %}

        <div class="product-price">
          {% if product.compare_at_price > product.price %}
            <span class="price-compare">{{ product.compare_at_price | money }}</span>
          {% endif %}
          <span class="price-current">{{ product.price | money }}</span>
        </div>

        <!-- Product Form -->
        {% form 'product', product, id: 'product-form' %}
          {% if product.variants.size > 1 %}
            <div class="product-variants">
              <label for="variant-selector">Size</label>
              <select name="id" id="variant-selector" class="variant-select">
                {% for variant in product.variants %}
                  <option
                    value="{{ variant.id }}"
                    {% if variant == product.selected_or_first_available_variant %}
                      selected
                    {% endif %}
                  >
                    {{ variant.title }} - {{ variant.price | money }}
                  </option>
                {% endfor %}
              </select>
            </div>
          {% else %}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          {% endif %}

          <button
            type="submit"
            name="add"
            class="btn btn-primary btn-large add-to-cart-btn"
            {% unless product.available %}
              disabled
            {% endunless %}
          >
            {% if product.available %}
              Add to Cart
            {% else %}
              Sold Out
            {% endif %}
          </button>
        {% endform %}

        <!-- Product Description -->
        {% if product.description != blank %}
          <div class="product-description">
            {{ product.description }}
          </div>
        {% endif %}

        <!-- Features -->
        {% if product.metafields.custom.features %}
          <div class="product-features">
            <h3 class="features-title serif">Key Features</h3>
            <ul class="features-list">
              {% assign features = product.metafields.custom.features | split: ',' %}
              {% for feature in features %}
                <li>{{ feature }}</li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <!-- Use Cases -->
        {% if product.metafields.custom.use_cases %}
          <div class="product-use-cases">
            <h3 class="use-cases-title serif">Perfect For</h3>
            <div class="use-cases-tags">
              {% assign use_cases = product.metafields.custom.use_cases | split: ',' %}
              {% for use_case in use_cases %}
                <span class="use-case-tag">{{ use_case }}</span>
              {% endfor %}
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<style>
  .product-page {
    padding: 8rem 0 4rem;
  }

  .product-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 4rem;
  }

  @media (min-width: 1024px) {
    .product-grid {
      grid-template-columns: 1fr 1fr;
      gap: 6rem;
    }
  }

  .product-images {
    position: sticky;
    top: 120px;
  }

  .main-image {
    border-radius: 2rem;
    overflow: hidden;
    margin-bottom: 1.5rem;
    box-shadow: 0 20px 60px -10px rgba(26, 46, 38, 0.15);
    background-color: var(--color-background);
  }

  .main-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  .thumbnail-gallery {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }

  .thumbnail {
    border: 2px solid transparent;
    border-radius: 1rem;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s;
    background: none;
    padding: 0;
  }

  .thumbnail:hover,
  .thumbnail.active {
    border-color: var(--color-secondary);
  }

  .thumbnail img {
    width: 100%;
    height: auto;
    display: block;
  }

  .product-scent {
    color: var(--color-accent);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    font-size: 0.875rem;
    display: block;
    margin-bottom: 1rem;
  }

  .product-title {
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .product-short-desc {
    font-size: 1.125rem;
    color: rgba(26, 46, 38, 0.7);
    margin-bottom: 2rem;
    line-height: 1.6;
  }

  .product-price {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .price-compare {
    font-size: 1.25rem;
    color: rgba(26, 46, 38, 0.4);
    text-decoration: line-through;
  }

  .price-current {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-secondary);
  }

  .product-variants {
    margin-bottom: 2rem;
  }

  .product-variants label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .variant-select {
    width: 100%;
    padding: 1rem 1.5rem;
    border: 2px solid rgba(26, 46, 38, 0.2);
    border-radius: 1rem;
    font-size: 1rem;
    font-family: inherit;
    background-color: white;
    cursor: pointer;
  }

  .btn-large {
    width: 100%;
    padding: 1.25rem 2rem;
    font-size: 1.125rem;
    margin-bottom: 2rem;
  }

  .product-description {
    padding: 2rem 0;
    border-top: 1px solid rgba(26, 46, 38, 0.1);
    color: rgba(26, 46, 38, 0.7);
    line-height: 1.8;
  }

  .product-features,
  .product-use-cases {
    padding: 2rem 0;
    border-top: 1px solid rgba(26, 46, 38, 0.1);
  }

  .features-title,
  .use-cases-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }

  .features-list {
    list-style: none;
    padding: 0;
  }

  .features-list li {
    padding-left: 2rem;
    position: relative;
    margin-bottom: 1rem;
    color: rgba(26, 46, 38, 0.7);
  }

  .features-list li::before {
    content: 'âœ“';
    position: absolute;
    left: 0;
    color: var(--color-secondary);
    font-weight: 700;
  }

  .use-cases-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .use-case-tag {
    background-color: var(--color-background);
    padding: 0.5rem 1.25rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-secondary);
    border: 1px solid rgba(26, 46, 38, 0.1);
  }
</style>

<script>
  function changeImage(src, element) {
    document.getElementById('main-product-image').src = src;
    document.querySelectorAll('.thumbnail').forEach((thumb) => thumb.classList.remove('active'));
    element.classList.add('active');
  }
</script>

{% schema %}
{
  "name": "Product Information",
  "settings": []
}
{% endschema %}
